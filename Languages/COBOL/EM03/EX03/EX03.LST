* Microsoft COBOL Version 4.5        L2.4 revision 002 13-Nov-23 17:53 Page   1
*                                       EX03.CBL
* Options: LIST(EX03.LST) ASMLIST(EX03.GRP)
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID.     EX03.
     3 AUTHOR.         LUIZ HENRIQUE DE SANTANA
     4                 GABRIEL GOMES DA CRUZ
     5                 NICOLE CARVALHO FUKUSHIMA.
     6 INSTALLATION.   FATEC-SP.
     7 DATE-WRITTEN.   11/11/2023.
     8 DATE-COMPILED. 13-Nov-23 17:53.
     9 SECURITY. APENAS O AUTOR PODE MODIFICAR.
    10*REMARKS.  LER ARQUIVO DE ENTRADA CADENT E CLASSIFICAR OS
    11*          DADOS NO ARQUIVO DE SAIDA CADSAI, ORDENANDO POR
    12*          CODIGO EM ORDEM ASCENDENTE, EXIBINDO APENAS
    13*          OS REGISTRO COM DEPARTAMENTO 01 E 02.
    14
    15 ENVIRONMENT DIVISION.
    16 CONFIGURATION SECTION.
    17 OBJECT-COMPUTER. IBM-PC.
    18 SOURCE-COMPUTER. IBM-PC.
    19 SPECIAL-NAMES.   DECIMAL-POINT IS COMMA.
    20
    21 INPUT-OUTPUT SECTION.
    22 FILE-CONTROL.
    23 SELECT CADENT ASSIGN TO DISK ORGANIZATION IS LINE
    24     SEQUENTIAL.
    25 SELECT TRAB ASSIGN TO DISK.
    26 SELECT CADSAI ASSIGN TO DISK ORGANIZATION IS LINE
    27     SEQUENTIAL.
    28
    29 DATA DIVISION.
    30 FILE SECTION.
    31
    32 FD CADENT LABEL RECORD ARE STANDARD VALUE OF FILE-ID
    33     IS "CADENT.DAT".
    34 01 REG-ENT.
    35     02 COD-ENT      PIC 9(05).
    36     02 NOME-ENT     PIC X(30).
    37     02 DEP-ENT      PIC 9(02).
    38       88 DEP-VALIDO VALUE 01 02.
    39
    40 SD TRAB.
    41 01 REG-TRAB.
    42     02 COD-TRAB    PIC 9(05).
    43     02 NOME-TRAB   PIC X(30).
    44     02 DEP-TRAB    PIC X(02).
    45
    46 FD CADSAI LABEL RECORD ARE STANDARD VALUE OF FILE-ID
    47     IS "CADSAI.DAT".
    48 01 REG-SAI.
    49     02 COD-SAI      PIC 9(05).
    50     02 NOME-SAI     PIC X(30).
    51     02 DEP-SAI      PIC X(02).
    52
    53 WORKING-STORAGE SECTION.
    54 77 FIM-ARQ PIC XXX VALUE "NAO".
    55
    56 PROCEDURE DIVISION.
    57 PGM-EX03.
* Microsoft COBOL Version 4.5        L2.4 revision 002 13-Nov-23 17:53 Page   2
*                                       EX03.CBL
    58     SORT TRAB ASCENDING KEY COD-TRAB
    59         INPUT PROCEDURE ROTINA-ENT GIVING CADSAI.
    60     STOP RUN.
    61
    62 ROTINA-ENT SECTION.
    63     PERFORM INICIO.
    64     PERFORM PRINCIPAL UNTIL FIM-ARQ EQUAL "SIM".
    65     PERFORM FIM.
    66
    67 INICIO SECTION.
    68     OPEN INPUT CADENT.
    69     PERFORM LEITURA.
    70
    71 LEITURA SECTION.
    72     READ CADENT AT END MOVE "SIM" TO FIM-ARQ.
    73
    74 PRINCIPAL SECTION.
    75     PERFORM SELECAO.
    76     PERFORM LEITURA.
    77
    78 SELECAO SECTION.
    79     IF DEP-VALIDO
    80         PERFORM GRAVACAO.
    81
    82 GRAVACAO SECTION.
    83     MOVE COD-ENT TO COD-TRAB.
    84     MOVE NOME-ENT TO NOME-TRAB.
    85     RELEASE REG-TRAB.
    86
    87 FIM SECTION.
    88     CLOSE CADENT.
* Microsoft COBOL Version 4.5        L2.4 revision 002
* (C)Copyright Microsoft Corp 1984, 1991       URN AXUPA/MS0/000000
*                                              REF GNB-024050002A7
*
* Total Messages:     0
* Data:        1268     Code:         515     Dictionary:        1622
