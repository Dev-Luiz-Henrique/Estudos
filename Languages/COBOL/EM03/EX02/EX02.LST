* Microsoft COBOL Version 4.5        L2.4 revision 002 13-Nov-23 17:57 Page   1
*                                       EX02.CBL
* Options: LIST(EX02.LST) ASMLIST(EX02.GRP)
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID.     EX02.
     3 AUTHOR.         LUIZ HENRIQUE DE SANTANA
     4                 GABRIEL GOMES DA CRUZ
     5                 NICOLE CARVALHO FUKUSHIMA.
     6 INSTALLATION.   FATEC-SP.
     7 DATE-WRITTEN.   07/11/2023.
     8 DATE-COMPILED. 13-Nov-23 17:57.
     9 SECURITY. APENAS O AUTOR PODE MODIFICAR.
    10*REMARKS.  LER ARQUIVO DE ENTRADA CADENT E CLASSIFICAR OS
    11*          DADOS NO ARQUIVO DE SAIDA CADSAI, ORDENANDO POR
    12*          CODIGO EM ORDEM DESCENDENTE, EXIBINDO APENAS
    13*          OS REGISTRO DE SEXO MASCULINOS.
    14
    15 ENVIRONMENT DIVISION.
    16 CONFIGURATION SECTION.
    17 SOURCE-COMPUTER. IBM-PC.
    18 OBJECT-COMPUTER. IBM-PC.
    19 SPECIAL-NAMES.   DECIMAL-POINT IS COMMA.
    20
    21 INPUT-OUTPUT SECTION.
    22 FILE-CONTROL.
    23 SELECT CADENT ASSIGN TO DISK ORGANIZATION IS
    24     LINE SEQUENTIAL.
    25 SELECT TRAB ASSIGN TO DISK.
    26 SELECT CADSAI ASSIGN TO DISK ORGANIZATION IS
    27     LINE SEQUENTIAL.
    28
    29 DATA DIVISION.
    30 FILE SECTION.
    31
    32 FD CADENT LABEL RECORD ARE STANDARD VALUE OF FILE-ID
    33     IS "CADENT.DAT".
    34 01 REG-ENT.
    35     02 COD-ENT      PIC 9(05).
    36     02 NOME-ENT     PIC X(30).
    37     02 SEX-ENT      PIC X(01).
    38
    39 SD TRAB.
    40 01 REG-TRAB.
    41     02 COD-TRAB    PIC 9(05).
    42     02 NOME-TRAB   PIC X(30).
    43     02 SEX-TRAB    PIC X(01).
    44
    45 FD CADSAI LABEL RECORD ARE STANDARD VALUE OF FILE-ID
    46     IS "CADSAI.DAT".
    47 01 REG-SAI.
    48     02 COD-SAI      PIC 9(05).
    49     02 NOME-SAI     PIC X(30).
    50     02 SEX-SAI      PIC X(01).
    51
    52 WORKING-STORAGE SECTION.
    53 77 FIM-ARQ PIC XXX VALUE "NAO".
    54
    55 PROCEDURE DIVISION.
    56 PGM-EX01.
    57     SORT TRAB DESCENDING KEY COD-TRAB
* Microsoft COBOL Version 4.5        L2.4 revision 002 13-Nov-23 17:57 Page   2
*                                       EX02.CBL
    58         USING CADENT OUTPUT PROCEDURE ROT-SAI.
    59     STOP RUN.
    60
    61 ROT-SAI SECTION.
    62     PERFORM INICIO.
    63     PERFORM PRINCIPAL UNTIL FIM-ARQ EQUAL "SIM".
    64     PERFORM TERMINO.
    65
    66 INICIO SECTION.
    67     OPEN OUTPUT CADSAI.
    68     PERFORM LEITURA.
    69
    70 LEITURA SECTION.
    71     RETURN TRAB AT END MOVE "SIM" TO FIM-ARQ.
    72
    73 PRINCIPAL SECTION.
    74     PERFORM SELECAO.
    75     PERFORM LEITURA.
    76
    77 SELECAO SECTION.
    78     IF SEX-TRAB EQUAL "M"
    79         PERFORM GRAVACAO.
    80
    81 GRAVACAO SECTION.
    82     MOVE COD-TRAB TO COD-SAI.
    83     MOVE NOME-TRAB TO NOME-SAI.
    84     WRITE REG-SAI.
    85
    86 TERMINO SECTION.
    87     CLOSE CADSAI.
* Microsoft COBOL Version 4.5        L2.4 revision 002
* (C)Copyright Microsoft Corp 1984, 1991       URN AXUPA/MS0/000000
*                                              REF GNB-024050002A7
*
* Total Messages:     0
* Data:        1244     Code:         494     Dictionary:        1564
