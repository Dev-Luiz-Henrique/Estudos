* Microsoft COBOL Version 4.5        L2.4 revision 002 06-Nov-23 19:07 Page   1
*                                       SORT.CBL
* Options: LIST(SORT.LST) ASMLIST(SORT.GRP)
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID.     EXSORT.
     3 AUTHOR.         LUIZ HENRIQUE DE SANTANA.
     4 INSTALLATION.   FATEC-SP.
     5 DATE-WRITTEN.   31/10/2023.
     6 DATE-COMPILED. 06-Nov-23 19:07.
     7 SECURITY.       APENAS O AUTOR PODE MODIFICA-LO.
     8*REMARKS.        FAZ O SORT DO ARQUIVO DE ENTRADA.
     9*                USANDO INPUT E GIVING SELECIONAR SOMENTE
    10*                PESSOA DO SEXO MASCULINO (M) GERANDO COMO
    11*                SAIDA UM ARQUIVO CLASSIFICADO.
    12
    13 ENVIRONMENT DIVISION.
    14 CONFIGURATION SECTION.
    15     SOURCE-COMPUTER. IBM-PC.
    16     OBJECT-COMPUTER. IBM-PC.
    17     SPECIAL-NAMES. DECIMAL-POINT IS COMMA.
    18
    19 INPUT-OUTPUT SECTION.
    20 FILE-CONTROL.
    21     SELECT ENTRADA ASSIGN TO DISK ORGANIZATION
    22         IS LINE SEQUENTIAL.
    23     SELECT TRAB ASSIGN TO DISK.
    24     SELECT SAIDA ASSIGN TO DISK ORGANIZATION
    25         IS LINE SEQUENTIAL.
    26
    27 DATA DIVISION.
    28 FILE SECTION.
    29 FD ENTRADA LABEL RECORD ARE STANDARD
    30     VALUE OF FILE-ID IS "ENT.DAT".
    31 01 REG-ENT.
    32     02 COD-ENT      PIC 9(04).
    33     02 SEXO-ENT     PIC X(01).
    34     02 NOME-ENT     PIC X(30).
    35
    36 SD TRAB.
    37 01 REG-TRAB.
    38     02 COD-TRAB     PIC 9(04).
    39     02 SEXO-TRAB    PIC X(01).
    40     02 NOME-TRAB    PIC X(30).
    41
    42 FD SAIDA LABEL RECORD ARE STANDARD
    43     VALUE OF FILE-ID IS "SAI.DAT".
    44 01 REG-SAI.
    45     02 COD-SAI      PIC 9(04).
    46     02 SEXO-SAI     PIC X(01).
    47     02 NOME-SAI     PIC X(30).
    48
    49 WORKING-STORAGE SECTION.
    50 77 FIM-ARQ PIC X(03) VALUE "NAO".
    51
    52 PROCEDURE DIVISION.
    53 PGM-EXSORT.
    54     SORT TRAB ASCENDING KEY COD-TRAB
    55         INPUT PROCEDURE ROTINA-ENT
    56         GIVING SAIDA.
    57     STOP RUN.
* Microsoft COBOL Version 4.5        L2.4 revision 002 06-Nov-23 19:07 Page   2
*                                       SORT.CBL
    58
    59 ROTINA-ENT SECTION.
    60     PERFORM INICIO.
    61     PERFORM PRINCIPAL UNTIL FIM-ARQ EQUAL "SIM".
    62     PERFORM TERMINO.
    63
    64 INICIO SECTION.
    65     OPEN INPUT ENTRADA.
    66     PERFORM LEITURA.
    67
    68 LEITURA SECTION.
    69     READ ENTRADA AT END MOVE "SIM" TO FIM-ARQ.
    70
    71 PRINCIPAL SECTION.
    72     PERFORM SELECAO.
    73     PERFORM LEITURA.
    74
    75 SELECAO SECTION.
    76     IF SEXO-ENT EQUAL "M"
    77         PERFORM GRAVACAO.
    78
    79 GRAVACAO SECTION.
    80     MOVE COD-ENT TO COD-TRAB.
    81     MOVE SEXO-ENT TO SEXO-TRAB.
    82     MOVE NOME-ENT TO NOME-TRAB.
    83     RELEASE REG-TRAB.
    84
    85 TERMINO SECTION.
    86     CLOSE ENTRADA.
* Microsoft COBOL Version 4.5        L2.4 revision 002
* (C)Copyright Microsoft Corp 1984, 1991       URN AXUPA/MS0/000000
*                                              REF GNB-024050002A7
*
* Total Messages:     0
* Data:        1244     Code:         488     Dictionary:        1574
