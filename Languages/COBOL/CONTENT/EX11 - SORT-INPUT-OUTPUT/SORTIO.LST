* Microsoft COBOL Version 4.5        L2.4 revision 002 07-Nov-23 08:24 Page   1
*                                      SORTIO.CBL
* Options: LIST(SORTIO.LST) ASMLIST(SORTIO.GRP)
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID.     EXSORTIO.
     3 AUTHOR.         LUIZ HENRIQUE DE SANTANA.
     4 INSTALLATION.   FATEC-SP.
     5 DATE-WRITTEN.   31/10/2023.
     6 DATE-COMPILED. 07-Nov-23 08:24.
     7 SECURITY.       APENAS O AUTOR PODE MODIFICA-LO.
     8*REMARKS. FAZ O SORT DO ARQUIVO DE ENTRADA.
     9*            USANDO USING E OUTPUT.
    10*            SELECIONAR SOMENTE PESSOA DO SEXO
    11*            FEMININO (F) GERANDO COMO SAIDA UM
    12*            ARQUIVO CLASSIFICADO.
    13
    14 ENVIRONMENT DIVISION.
    15 CONFIGURATION SECTION.
    16     SOURCE-COMPUTER. IBM-PC.
    17     OBJECT-COMPUTER. IBM-PC.
    18     SPECIAL-NAMES.   DECIMAL-POINT IS COMMA.
    19
    20 INPUT-OUTPUT SECTION.
    21 FILE-CONTROL.
    22     SELECT ENTRADA ASSIGN TO DISK ORGANIZATION
    23         IS LINE SEQUENTIAL.
    24     SELECT TRAB ASSIGN TO DISK.
    25     SELECT RELAT ASSIGN TO DISK.
    26
    27 DATA DIVISION.
    28 FILE SECTION.
    29 FD ENTRADA LABEL RECORD ARE STANDARD
    30     VALUE OF FILE-ID IS "ENT.DAT".
    31 01 REG-ENT.
    32     02 COD-ENT PIC 9(04).
    33     02 SEXO-ENT PIC X(01).
    34     02 NOME-ENT PIC X(30).
    35
    36 SD TRAB.
    37 01 REG-TRAB.
    38     02 COD-TRAB PIC 9(04).
    39     02 SEXO-TRAB PIC X(01).
    40     02 NOME-TRAB PIC X(30).
    41
    42 FD RELAT LABEL RECORD IS OMITTED.
    43 01 REG-REL PIC X(80).
    44
    45 WORKING-STORAGE SECTION.
    46 77 FIM-ARQ PIC X(03) VALUE "NAO".
    47 77 CT-LIN PIC 9(02) VALUE 25.
    48 77 CT-PAG PIC 9(02) VALUE ZEROES.
    49
    50 01 CAB-01.
    51     02 FILLER PIC X(70) VALUE SPACES.
    52     02 FILLER PIC X(05) VALUE "PAG. ".
    53     02 VAR-PAG PIC 99.
    54     02 FILLER PIC X(03) VAlUE SPACES.
    55     01 CAB-02.
    56     02 FILLER PIC X(15) VALUE SPACES.
    57     02 FILLER PIC X(25) VALUE "RELATÃ“RIO DE USUARIOS DO".
* Microsoft COBOL Version 4.5        L2.4 revision 002 07-Nov-23 08:24 Page   2
*                                      SORTIO.CBL
    58     02 FILLER PIC X(15) VALUE " SEXO MASCULINO".
    59     02 FILLER PIC X(25) VALUE SPACES.
    60
    61 01 CAB-03.
    62     02 FILLER PIC X(05) VALUE SPACES.
    63     02 FILLER PIC X(06) VALUE "CODIGO".
    64     02 FILLER PIC X(10) VALUE SPACES.
    65     02 FILLER PIC X(04) VALUE "SEXO".
    66     02 FILLER PIC X(05) VALUE SPACES.
    67     02 FILLER PIC X(04) VALUE "NOME".
    68     02 FILLER PIC X(46) VALUE SPACES.
    69
    70 01 DETALHE.
    71     02 FILLER PIC X(05) VALUE SPACES.
    72     02 COD-DET PIC 9(04).
    73     02 FILLER PIC X(13) VALUE SPACES.
    74     02 SEXO-DET PIC X(01).
    75     02 FILLER PIC X(02) VALUE SPACES.
    76     02 NOME-DET PIC X(30) VALUE SPACES.
    77     02 FILLER PIC X(25) VALUE SPACES.
    78
    79 PROCEDURE DIVISION.
    80 PGM-SORTIO.
    81     SORT TRAB ASCENDING KEY COD-TRAB
    82         INPUT PROCEDURE ROT-ENT
    83         OUTPUT PROCEDURE ROT-SAI.
    84     STOP RUN.
    85
    86 ROT-ENT SECTION.
    87     PERFORM INICIO-ENT.
    88     PERFORM PRINCIPAL-ENT UNTIL FIM-ARQ EQUAL "SIM".
    89     PERFORM FIM-ENT.
    90 INICIO-ENT SECTION.
    91     OPEN INPUT ENTRADA.
    92     PERFORM LEITURA-ENT.
    93
    94 LEITURA-ENT SECTION.
    95     READ ENTRADA AT END MOVE "SIM" TO FIM-ARQ.
    96
    97 PRINCIPAL-ENT SECTION.
    98     PERFORM SELECAO-ENT.
    99     PERFORM LEITURA-ENT.
   100
   101 SELECAO-ENT SECTION.
   102     IF SEXO-ENT EQUAL "M"
   103     PERFORM GRAVACAO-ENT.
   104
   105 GRAVACAO-ENT SECTION.
   106     MOVE COD-ENT TO COD-TRAB.
   107     MOVE SEXO-ENT TO SEXO-TRAB.
   108     MOVE NOME-ENT TO NOME-TRAB.
   109     RELEASE REG-TRAB.
   110
   111 FIM-ENT SECTION.
   112     CLOSE ENTRADA.
   113
   114 ROT-SAI SECTION.
   115     PERFORM INICIO-SAI.
* Microsoft COBOL Version 4.5        L2.4 revision 002 07-Nov-23 08:24 Page   3
*                                      SORTIO.CBL
   116     PERFORM PRINCIPAL-SAI UNTIL FIM-ARQ EQUAL "SIM".
   117     PERFORM FIM-SAI.
   118
   119 INICIO-SAI SECTION.
   120     MOVE "NAO" TO FIM-ARQ.
   121     OPEN OUTPUT RELAT.
   122     PERFORM LEITURA-SAI.
   123
   124 LEITURA-SAI SECTION.
   125     RETURN TRAB AT END MOVE "SIM" TO FIM-ARQ.
   126
   127 PRINCIPAL-SAI SECTION.
   128     PERFORM IMPRESSAO-SAI.
   129     PERFORM LEITURA-SAI.
   130
   131 IMPRESSAO-SAI SECTION.
   132     IF CT-LIN GREATER THAN 24
   133         PERFORM CABECALHO-SAI.
   134     PERFORM DETALHE-SAI.
   135
   136 CABECALHO-SAI SECTION.
   137     ADD 1 TO CT-PAG.
   138     MOVE CT-PAG TO VAR-PAG.
   139     MOVE SPACES TO REG-REL.
   140     WRITE REG-REL AFTER ADVANCING PAGE.
   141     WRITE REG-REL FROM CAB-01 AFTER ADVANCING 1 LINE.
   142     WRITE REG-REL FROM CAB-02 AFTER ADVANCING 2 LINES.
   143     WRITE REG-REL FROM CAB-03 AFTER ADVANCING 2 LINES.
   144     MOVE ZEROES TO CT-LIN.
   145
   146  DETALHE-SAI SECTION.
   147     MOVE COD-TRAB TO COD-DET.
   148     MOVE SEXO-TRAB TO SEXO-DET.
   149     MOVE NOME-TRAB TO NOME-DET.
   150     WRITE REG-REL FROM DETALHE AFTER ADVANCING 1 LINE.
   151     ADD 1 TO CT-LIN.
   152
   153 FIM-SAI SECTION.
   154     CLOSE RELAT.
* Microsoft COBOL Version 4.5        L2.4 revision 002
* (C)Copyright Microsoft Corp 1984, 1991       URN AXUPA/MS0/000000
*                                              REF GNB-024050002A7
*
* Total Messages:     0
* Data:        1628     Code:         925     Dictionary:        2355
