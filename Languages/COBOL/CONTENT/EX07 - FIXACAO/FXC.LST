* Microsoft COBOL Version 4.5        L2.4 revision 002 23-Oct-23 22:31 Page   1
*                                       FXC.CBL
* Options: LIST(FXC.LST) ASMLIST(FXC.GRP)
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID.             FXC.
     3 AUTHOR.                 LUIZ HENRIQUE DE SANTANA.
     4 INSTALLATION.           FATEC-SP.
     5 DATE-WRITTEN.           23/10/2023.
     6 DATE-COMPILED. 23-Oct-23 22:31.
     7 SECURITY.               APENAS O AUTOR PODE MODIFICAR.
     8*REMARKS
     9
    10 ENVIRONMENT DIVISION.
    11 CONFIGURATION SECTION.
    12     OBJECT-COMPUTER.    LG-PC.
    13     SOURCE-COMPUTER.    LG-PC.
    14     SPECIAL-NAMES.      DECIMAL-POINT IS COMMA.
    15
    16 INPUT-OUTPUT SECTION.
    17 FILE-CONTROL.
    18     SELECT CADENT ASSIGN TO DISK ORGANIZATION IS LINE
    19         SEQUENTIAL.
    20     SELECT RELSAI ASSIGN TO DISK.
    21
    22 DATA DIVISION.
    23 FILE SECTION.
    24
    25 FD CADENT LABEL RECORD ARE STANDARD
    26     VALUE OF FILE-ID IS "CADENT.DAT".
    27
    28     01 REG-ENT.
    29       02 CPF-ENT           PIC 9(11).
    30       02 RED-CPF-ENT REDEFINES CPF-ENT.
    31         03 NUM-CPF         PIC 9(09).
    32         03 DIGITOS-CPF     PIC 9(02).
    33       02 NOME-CLIE-ENT     PIC X(30).
    34       02 ESTADO-ENT        PIC X(02).
    35       02 CIDADE-ENT        PIC X(30).
    36       02 TELL-ENT          PIC 9(08).
    37       02 DT-VISIT-ENT      PIC 9(08).
    38       02 RED-DT-VISOT-ENT REDEFINES DT-VISIT-ENT.
    39         03 DD-ENT          PIC 9(02).
    40         03 MM-ENT          PIC 9(02).
    41         03 AAAA-ENT        PIC 9(04).
    42
    43 FD RELSAI LABEL RECORD IS OMITTED.
    44     01 REL-SAI PIC X(80).
    45
    46 WORKING-STORAGE SECTION.
    47     77 FIM-ARQ             PIC X(03) VALUE "NAO".
    48     77 CT-LIN              PIC 9(02) VALUE 41.
    49     77 CT-PAG              PIC 9(02) VALUE ZEROS.
    50     77 CT-CLIE             PIC 9(05) VALUE ZEROS.
    51
    52     01 CAB-01.
    53       02 FILLER PIC X(70) VALUE SPACES.
    54       02 FILLER PIC X(05) VALUE "PAG. ".
    55       02 VAR-PAG PIC 999.
    56       02 FILLER PIC X(02) VALUE SPACES.
    57
* Microsoft COBOL Version 4.5        L2.4 revision 002 23-Oct-23 22:31 Page   2
*                                       FXC.CBL
    58     01 CAB-02.
    59       02 FILLER PIC X(32) VALUE SPACES.
    60       02 FILLER PIC X(17) VALUE "TURISMAR TURISMOS".
    61       02 FILLER PIC X(33) VALUE SPACES.
    62
    63     01 CAB-03.
    64       02 FILLER PIC X(22) VALUE SPACES.
    65       02 FILLER PIC X(24) VALUE "CLIENTES NO PERIODO DE: ".
    66       02 FILLER PIC X(11) VALUE "2010 A 2011".
    67       02 FILLER PIC X(23) VALUE SPACES.
    68
    69     01 CAB-04.
    70       02 FILLER PIC X(17) VALUE SPACES.
    71       02 FILLER PIC X(04) VALUE "NOME".
    72       02 FILLER PIC X(22) VALUE SPACES.
    73       02 FILLER PIC X(03) VALUE "CPF".
    74       02 FILLER PIC X(09) VALUE SPACES.
    75       02 FILLER PIC X(21) VALUE "DATA DA ULTIMA VISITA".
    76       02 FILLER PIC X(04) VALUE SPACES.
    77
    78     01 CAB-05.
    79       02 FILLER PIC X(58) VALUE SPACES.
    80       02 FILLER PIC X(15) VALUE "DIA / MES / ANO".
    81       02 FILLER PIC X(07) VALUE SPACES.
    82
    83     01 DETALHE.
    84       02 FILLER PIC X(04) VALUE SPACES.
    85       02 DET-NOME PIC X(30).
    86       02 FILLER PIC X(04) VALUE SPACES.
    87       02 DET-CPF-NUM PIC 999.999.999.
    88       02 FILLER PIC X VALUE "/".
    89       02 DET-CPF-DIGITOS PIC 99.
    90       02 FILLER PIC X(04) VALUE SPACES.
    91       02 DET-DATA.
    92         03 DET-DD PIC 99.
    93         03 FILLER PIC XXX VALUE " / ".
    94         03 DET-MM PIC X(09).
    95         03 FILLER PIC XXX VALUE " / ".
    96         03 DET-AAAA PIC 9999.
    97       02 FILLER PIC X(03) VALUE SPACES.
    98
    99     01 ROD-01.
   100       02 FILLER PIC X(04) VALUE SPACES.
   101       02 FILLER PIC X(19) VALUE "TOTAL DE CLIENTES: ".
   102       02 VAR-CLIE PIC 9999.
   103       02 FILLER PIC X(53) VALUE SPACES.
   104
   105     01 TABELA-MESES.
   106       02 DEF-MESES.
   107         03 FILLER PIC X(09) VALUE "  JANEIRO".
   108         03 FILLER PIC X(09) VALUE "FEVEREIRO".
   109         03 FILLER PIC X(09) VALUE "    MARCO".
   110         03 FILLER PIC X(09) VALUE "    ABRIL".
   111         03 FILLER PIC X(09) VALUE "     MAIO".
   112         03 FILLER PIC X(09) VALUE "    JUNHO".
   113         03 FILLER PIC X(09) VALUE "    JULHO".
   114         03 FILLER PIC X(09) VALUE "   AGOSTO".
   115         03 FILLER PIC X(09) VALUE " SETEMBRO".
* Microsoft COBOL Version 4.5        L2.4 revision 002 23-Oct-23 22:31 Page   3
*                                       FXC.CBL
   116         03 FILLER PIC X(09) VALUE "  OUTUBRO".
   117         03 FILLER PIC X(09) VALUE " NOVEMBRO".
   118         03 FILLER PIC X(09) VALUE " DEZEMBRO".
   119
   120     01 RED-TABELA-MESES REDEFINES TABELA-MESES.
   121       02 MESES PIC X(09) OCCURS 12 TIMES.
   122
   123 PROCEDURE DIVISION.
   124 PGM-FIXAR.
   125     PERFORM INICIO.
   126     PERFORM PRINCIPAL UNTIL FIM-ARQ EQUAL "SIM".
   127     PERFORM TERMINO.
   128     STOP RUN.
   129
   130 INICIO.
   131     OPEN INPUT CADENT OUTPUT RELSAI.
   132     PERFORM LEITURA.
   133
   134 LEITURA.
   135     READ CADENT AT END MOVE "SIM" TO FIM-ARQ.
   136
   137 PRINCIPAL.
   138     PERFORM IMPRESSAO.
   139     PERFORM LEITURA.
   140
   141 IMPRESSAO.
   142     IF CT-LIN GREATER THAN 40
   143         PERFORM CABECALHO.
   144     PERFORM IMP-DET.
   145
   146 CABECALHO.
   147     MOVE 1 TO CT-LIN.
   148     ADD 1 TO CT-PAG.
   149     MOVE CT-PAG TO VAR-PAG.
   150     MOVE SPACES TO REL-SAI.
   151     WRITE REL-SAI AFTER ADVANCING PAGE.
   152     WRITE REL-SAI FROM CAB-01 AFTER ADVANCING 1 LINE.
   153     WRITE REL-SAI FROM CAB-02 AFTER ADVANCING 2 LINES.
   154     WRITE REL-SAI FROM CAB-03 AFTER ADVANCING 2 LINES.
   155     WRITE REL-SAI FROM CAB-04 AFTER ADVANCING 1 LINE.
   156     WRITE REL-SAI FROM CAB-05 AFTER ADVANCING 1 LINE.
   157     MOVE ALL "-" TO REL-SAI.
   158     WRITE REL-SAI.
   159     MOVE SPACES TO REL-SAI.
   160     WRITE REL-SAI.
   161
   162 IMP-DET.
   163     MOVE NOME-CLIE-ENT TO DET-NOME.
   164     MOVE NUM-CPF TO DET-CPF-NUM.
   165     MOVE DIGITOS-CPF TO DET-CPF-DIGITOS.
   166     MOVE DD-ENT TO DET-DD.
   167     MOVE MESES(MM-ENT) TO DET-MM.
   168     MOVE AAAA-ENT TO DET-AAAA.
   169     WRITE REL-SAI FROM DETALHE AFTER ADVANCING 1 LINE.
   170     ADD 1 TO CT-LIN.
   171     ADD 1 TO CT-CLIE.
   172
   173 RODAPE.
* Microsoft COBOL Version 4.5        L2.4 revision 002 23-Oct-23 22:31 Page   4
*                                       FXC.CBL
   174     MOVE CT-CLIE TO VAR-CLIE.
   175     WRITE REL-SAI FROM ROD-01 AFTER ADVANCING 3 LINE.
   176
   177 TERMINO.
   178     PERFORM RODAPE.
   179     CLOSE CADENT RELSAI.
* Microsoft COBOL Version 4.5        L2.4 revision 002
* (C)Copyright Microsoft Corp 1984, 1991       URN AXUPA/MS0/000000
*                                              REF GNB-024050002A7
*
* Total Messages:     0
* Data:        1840     Code:         755     Dictionary:        2413
