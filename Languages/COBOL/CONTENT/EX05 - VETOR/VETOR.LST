* Microsoft COBOL Version 4.5        L2.4 revision 002 26-Sep-23 08:26 Page   1
*                                      VETOR.CBL
* Options: LIST(VETOR.LST) ASMLIST(VETOR.GRP)
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID. TAB02.
     3 AUTHOR. LUIZ HENRIQUE DE SANTANA.
     4 INSTALLATION. FATEC-SP.
     5 DATE-WRITTEN. 26/09/2023.
     6 DATE-COMPILED. 26-Sep-23 08:26.
     7 SECURITY. APENAS O AUTOR PODE MODIFICA-LO.
     8*REMARKS. LE UM REGISTRO COM TABELA DE TEMPERATURA
     9* GRAVA OS TOTAIS DA CIDADE EM UM REGISTRO.
    10
    11 ENVIRONMENT DIVISION.
    12 CONFIGURATION SECTION.
    13     OBJECT-COMPUTER.   HP-PC.
    14     SOURCE-COMPUTER.   HP-PC.
    15     SPECIAL-NAMES.  DECIMAL-POINT IS COMMA.
    16
    17 INPUT-OUTPUT SECTION.
    18 FILE-CONTROL.
    19     SELECT ARQ-ENT ASSIGN TO DISK ORGANIZATION
    20         IS LINE SEQUENTIAL.
    21     SELECT CAD-SAI ASSIGN TO DISK ORGANIZATION
    22         IS LINE SEQUENTIAL.
    23
    24 DATA DIVISION.
    25 FILE SECTION.
    26 FD ARQ-ENT LABEL RECORD ARE STANDARD VALUE OF FILE-ID
    27     IS "ARQ-ENT.DAT".
    28
    29 01 REG-ENT.
    30     02 COD-CIDADE      PIC 9(002).
    31     02 TEMP-CIDADE     PIC 9(003) OCCURS 10 TIMES.
    32
    33 FD CAD-SAI LABEL RECORD ARE STANDARD VALUE OF FILE-ID
    34     IS "CAD-SAI.DAT".
    35
    36 01 REG-SAI.
    37     02 COD-SAI        PIC 9(002).
    38     02 MEDIA-SAI      PIC 9(003)V99.
    39
    40 WORKING-STORAGE SECTION.
    41 77 FIM-ARQ  PIC X(03)       VALUE "NAO".
    42 77 CTR      PIC 9(02)       VALUE ZEROS.
    43 77 TOTAL    PIC 9(13)V9(04) VALUE ZEROS.
    44
    45 PROCEDURE DIVISION.
    46 PGM-TAB01.
    47     PERFORM INICIO.
    48     PERFORM PRINCIPAL UNTIL FIM-ARQ EQUAL "SIM".
    49     PERFORM TERMINO.
    50     STOP RUN.
    51
    52 INICIO.
    53     OPEN INPUT ARQ-ENT OUTPUT CAD-SAI.
    54     PERFORM LEITURA.
    55
    56 LEITURA.
    57     READ ARQ-ENT AT END MOVE "SIM" TO FIM-ARQ.
* Microsoft COBOL Version 4.5        L2.4 revision 002 26-Sep-23 08:26 Page   2
*                                      VETOR.CBL
    58
    59 PRINCIPAL.
    60     PERFORM ACUMULA-TEMP.
    61     PERFORM GRAVA-SAI.
    62     PERFORM LEITURA.
    63
    64 ACUMULA-TEMP.
    65     MOVE ZEROS TO TOTAL.
    66     MOVE 1 TO CTR.
    67     PERFORM SOMA-TAB 10 TIMES.
    68     DIVIDE 10 INTO TOTAL.
    69
    70 SOMA-TAB.
    71     ADD TEMP-CIDADE(CTR) TO TOTAL.
    72     ADD 1 TO CTR.
    73
    74 GRAVA-SAI.
    75     MOVE COD-CIDADE TO COD-SAI.
    76     MOVE TOTAL TO MEDIA-SAI.
    77     WRITE REG-SAI.
    78
    79 TERMINO.
    80     CLOSE ARQ-ENT
    81           CAD-SAI.
* Microsoft COBOL Version 4.5        L2.4 revision 002
* (C)Copyright Microsoft Corp 1984, 1991       URN AXUPA/MS0/000000
*                                              REF GNB-024050002A7
*
* Total Messages:     0
* Data:        1040     Code:         374     Dictionary:        1207
