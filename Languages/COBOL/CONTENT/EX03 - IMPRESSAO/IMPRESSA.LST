* Microsoft COBOL Version 4.5        L2.4 revision 002 19-Sep-23 09:10 Page   1
*                                     IMPRESSA.CBL
* Options: LIST(IMPRESSA.LST) ASMLIST(IMPRESSA.GRP)
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID. IMPRIME.
     3 AUTHOR. LUIZ HENRIQUE / FELIPE DIAS.
     4 INSTALLATION. FATEC-SP.
     5 DATE-WRITTEN. 19/09/2023.
     6 DATE-COMPILED. 19-Sep-23 09:10.
     7 SECURITY. APENAS O AUTOR PODE MODIFICA-LO.
     8*REMARKS. LE UM REGISTRO E IMPRIME UM RELATORIO.
     9
    10 ENVIRONMENT DIVISION.
    11 CONFIGURATION SECTION.
    12     SOURCE-COMPUTER. IBM-PC.
    13     OBJECT-COMPUTER. IBM-PC.
    14     SPECIAL-NAMES. DECIMAL-POINT IS COMMA.
    15 INPUT-OUTPUT SECTION.
    16     FILE-CONTROL.
    17
    18     SELECT CAD-USU ASSIGN TO DISK
    19         ORGANIZATION IS LINE SEQUENTIAL.
    20     SELECT REL-ATR ASSIGN TO DISK.
    21
    22 DATA DIVISION.
    23 FILE SECTION.
    24 FD CAD-USU LABEL RECORD ARE STANDARD
    25  VALUE OF FILE-ID IS "CAD-USU.DAT".
    26
    27     01 REG-USU.
    28         02 COD-USU PIC 9(04).
    29         02 NOM-USU PIC X(30).
    30         02 REG-DATA.
    31             03 DIA PIC 9(02).
    32             03 MES PIC 9(02).
    33             03 ANO PIC 9(04).
    34         02 SIT-USU PIC 9(01).
    35
    36 FD REL-ATR LABEL RECORD IS OMITTED.
    37     01 REG-ATR PIC X(80).
    38
    39 WORKING-STORAGE SECTION.
    40     77 FIM-ARQ PIC X(03) VALUE "NAO".
    41     77 CT-LIN PIC 9(02) VALUE 25.
    42     77 CT-PAG PIC 9(02) VALUE ZEROES.
    43
    44 01 CAB-01.
    45     02 FILLER PIC X(70) VALUE SPACES.
    46     02 FILLER PIC X(05) VALUE "PAG. ".
    47     02 VAR-PAG PIC 99.
    48     02 FILLER PIC X(03) VALUE SPACES.
    49
    50 01 CAB-02.
    51     02 FILLER PIC X(15) VALUE SPACES.
    52     02 FILLER PIC X(21) VALUE "RELATORIO DE USUARIOS".
    53     02 FILLER PIC X(01) VALUE SPACES.
    54     02 FILLER PIC X(19) VALUE "GERAL DA BIBLIOTECA".
    55     02 FILLER PIC X(24) VALUE SPACES.
    56
    57 01 CAB-03.
* Microsoft COBOL Version 4.5        L2.4 revision 002 19-Sep-23 09:10 Page   2
*                                     IMPRESSA.CBL
    58     02 FILLER PIC X(5) VALUE SPACES.
    59     02 FILLER PIC X(6) VALUE "CODIGO".
    60     02 FILLER PIC X(19) VALUE SPACES.
    61     02 FILLER PIC X(4) VALUE "NOME".
    62     02 FILLER PIC X(20) VALUE SPACES.
    63     02 FILLER PIC X(21) VALUE "DATA DE CADASTRAMENTO".
    64     02 FILLER PIC X(5) VALUE SPACES.
    65
    66 01 DETALHE.
    67     02 FILLER PIC X(06) VALUE SPACES.
    68     02 COD PIC 9999.
    69     02 FILLER PIC X(06) VALUE SPACES.
    70     02 NOM PIC X(30).
    71     02 FILLER PIC X(13) VALUE SPACES.
    72     02 DDD PIC 99.
    73     02 FILLER PIC X(01) VALUE "/".
    74     02 MMM PIC 99.
    75     02 FILLER PIC X(01) VALUE "/".
    76     02 AAA PIC 9999.
    77     02 FILLER PIC X(11) VALUE SPACES.
    78
    79 PROCEDURE DIVISION.
    80
    81 EXEMPLO-IMPRESSAO.
    82     PERFORM INICIO.
    83     PERFORM PRINCIPAL UNTIL FIM-ARQ EQUAL "SIM".
    84     PERFORM FIM.
    85     STOP RUN.
    86
    87 INICIO.
    88     OPEN INPUT CAD-USU OUTPUT REL-ATR.
    89     PERFORM LEITURA.
    90
    91 LEITURA.
    92     READ CAD-USU AT END MOVE "SIM" TO FIM-ARQ.
    93
    94 PRINCIPAL.
    95     PERFORM IMPRESSAO.
    96     PERFORM LEITURA.
    97
    98 IMPRESSAO.
    99     IF CT-LIN GREATER THAN 24
   100         PERFORM CABECALHO.
   101     PERFORM IMPDET.
   102
   103 IMPDET.
   104     MOVE COD-USU TO COD.
   105     MOVE NOM-USU TO NOM.
   106     MOVE DIA TO DDD.
   107     MOVE MES TO MMM.
   108     MOVE ANO TO AAA.
   109     WRITE REG-ATR FROM DETALHE AFTER ADVANCING 1 LINE.
   110     ADD 1 TO CT-LIN.
   111
   112 CABECALHO.
   113     ADD 1 TO CT-PAG.
   114     MOVE CT-PAG TO VAR-PAG.
   115     MOVE SPACES TO REG-ATR.
* Microsoft COBOL Version 4.5        L2.4 revision 002 19-Sep-23 09:10 Page   3
*                                     IMPRESSA.CBL
   116     WRITE REG-ATR AFTER ADVANCING PAGE.
   117     WRITE REG-ATR FROM CAB-01 AFTER ADVANCING 1 LINE.
   118     WRITE REG-ATR FROM CAB-02 AFTER ADVANCING 2 LINES.
   119     WRITE REG-ATR FROM CAB-03 AFTER ADVANCING 2 LINES.
   120     MOVE ZEROES TO CT-LIN.
   121
   122 FIM.
   123     CLOSE CAD-USU
   124         REL-ATR.
   125
* Microsoft COBOL Version 4.5        L2.4 revision 002
* (C)Copyright Microsoft Corp 1984, 1991       URN AXUPA/MS0/000000
*                                              REF GNB-024050002A7
*
* Total Messages:     0
* Data:        1428     Code:         540     Dictionary:        1660
